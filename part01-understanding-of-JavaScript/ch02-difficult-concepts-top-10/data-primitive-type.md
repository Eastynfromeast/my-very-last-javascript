# 07. 자바스크립트는 왜 기본형, 참조형 데이터로 나뉠까(메모리 할당 방식의 차이) - 기본형

## 데이터 타입

- 기본형 Primitive

  - 불변성
  - 값 자체가 변수에 직접 저장됨
  - 복사할 때 값 자체가 복사됨
  - 종류
    - string
    - number
    - boolean
    - null : 값이 없음
    - undefined : 값이 할당되지 않음
    - symbol
    - Bigint

- 참조형 Reference

  - 크기가 가변적
  - 불변성 X
  - 메모리에 객체가 저장되고 변수는 그 메모리의 주소를 참조
  - 복사할 때 메모리 주소의 참조값이 복사됨
  - 종류
    - object : 키, 값
    - array : 데이터 집합
    - function : 실행 가능한 코드 블럭
    - RegExp
    - Set / WeakSet
    - Map / WeakMap

## 기본형 데이터 메모리 할당

```
let a = 1;
let b = 1;
```

_변수 영역_
| 변수명 | a | b |
| ------- | ---- | ---- |
| 주소 | @201 | @201 |

_데이터 영역_
| 주소 | 201 | 202 |
| ------ | ---- | ---- |
| 데이터 | 1 | |

- 변수 영역 : 식별자를 위한 공간 제공
  - 변수명 a - 주소 @201
  - 변수명 b - 주소 @201
- 데이터 영역 : 실제 값을 저장
  - 주소 201 - 데이터 1
- Q. 왜 이렇게 할까?
  - A. *메모리의 효율*과 값 복사의 단순화 때문
    - 변수 `b`와 같은 기본형 값이 있는지 확인한 후
    - 존재한다면 해당 데이터 영역의 주소 값을 참조해 메모리를 효율적으로 사용
    - 복사할 때도 데이터 메모리 영역의 주소만 복사하면 되기 때문에 복사 과정이 단순해지고 빨라짐

## 기본형 메모리 값 변경

```
let a = 1;
a = 2;
```

_변수 영역_
| 변수명 | a | |
| ------- | ---- | ---- |
| 주소 | @202 | |

_데이터 영역(Stack)_
| 주소 | 201 | 202 |
| ------ | ---- | ---- |
| 데이터 | 1 | 2 |

- 변수 `a`값을 수정할 경우

  - `@201`의 데이터 값을 변경하는 것이 아니라
  - 완전히 새로운 주소인 `@202`에 숫자 2를 할당
  - `a`는 새로운 메모리 주소를 참조

- => 자바스크립트 기본형 데이터가 불변성을 가지는 특성

  - 한번 생성된 값은 변경되지 않고
  - 값의 수정이 필요한 경우에는 새로운 값이 메모리에 할당됨
  - Why? 프로그램의 안정성과 예측 가능성이 향상됨
    - 데이터의 상태 변경을 최소화 해서
    - 부작용을 최소화하고
    - 프로그램 논리를 보다 명확하게 할 수 있음

- Q. 기본 변수에서 사용되던 숫자 1은 어떻게 되나요?
  - A. 기존 데이터를 사용하는 변수가 없다면 가비지 컬렉터에 의해 메모리에서 제거됨
  - 가비지 컬렉션 : 프로그램이 사용하지 않는 메모리를 자동으로 해지하는 일종의 프로세스
  - 자바스크립트 엔진은
    - 정기적으로 메모리를 스캔해서
    - 도달할 수 없는 객체를 찾아내고
    - 이런 객체를 메모리에서 해제
    - _Mark & Sweep_ algorithm : 객체의 가능성을 판단
      - _marking_ : 루트 집합에서 시작해서 루트들과 루트들이 참조하는 객체, 그 객체들이 참조하는 객체들을 마킹
        - 접근 가능한 모든 객체들이 식별됨
      - _sweep_ : 메모리를 스캔해 마킹되지 않은 객체들을 제거
        - 어떠한 루트에서도 접근되지 않은 객체로 더이상 이 애플리케이션에서 사용되지 않는 가비지로 간주됨
